@{
    var IsActive = "true";
}
<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="">
    <meta name="author" content="">

    <title>Canam Distributors INC</title>

    <!-- Bootstrap Core CSS -->
    <link href="~/css/bootstrap.min.css" rel="stylesheet">
    <!-- MetisMenu CSS -->
    <link href="~/css/metisMenu.min.css" rel="stylesheet">
    <!-- DataTables CSS -->
    <link href="~/css/dataTables/dataTables.bootstrap.css" rel="stylesheet">

    <!-- DataTables Responsive CSS -->
    <link href="~/css/dataTables/dataTables.responsive.css" rel="stylesheet">
    <!-- Timeline CSS -->
    <link href="~/css/timeline.css" rel="stylesheet">
    <!-- Custom CSS -->
    <link href="~/css/startmin.css" rel="stylesheet">
    <!-- Custom Fonts -->
    <link href="~/css/font-awesome.min.css" rel="stylesheet" type="text/css">

    <link href="https://cdn.jsdelivr.net/npm/froala-editor@3.2.6/css/froala_editor.pkgd.min.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/froala-editor@3.2.6/js/froala_editor.pkgd.min.js"></script>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/toastify-js/src/toastify.css">
    <script src="https://cdn.jsdelivr.net/npm/toastify-js/src/toastify.js"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/select2/4.0.13/css/select2.min.css" rel="stylesheet" />


    <style>
        .switch {
            position: relative;
            display: inline-block;
            width: 60px;
            height: 34px;
        }

            .switch input {
                opacity: 0;
                width: 0;
                height: 0;
            }

        .slider {
            position: absolute;
            cursor: pointer;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: #b0b0b0; /* Grey background color */
            transition: .4s;
            border-radius: 34px;
        }

            .slider:before {
                position: absolute;
                content: "";
                height: 26px;
                width: 26px;
                border-radius: 50%;
                left: 4px;
                bottom: 4px;
                background-color: white;
                transition: .4s;
            }

        input:checked + .slider {
            background-color: #4d4d4d; /* Darker grey for the checked state */
        }

            input:checked + .slider:before {
                transform: translateX(26px);
            }


        .file-input {
            display: flex;
            justify-content: center;
            align-items: center;
            width: 100%;
            height: 150px;
            border: 2px solid #ccc; /* Light grey border */
            border-radius: 8px; /* Slightly curved corners */
            background-color: rgba(240, 240, 240, 0.8); /* Foggy effect with transparency */
            color: #555; /* Darker text color */
            font-size: 18px;
            font-weight: bold;
            cursor: pointer;
            position: relative;
            text-align: center;
            transition: border-color 0.3s;
        }

            .file-input input[type="file"] {
                position: absolute;
                width: 100%;
                height: 100%;
                opacity: 0; /* Hide the default file input */
                cursor: pointer;
            }

            .file-input:hover {
                border-color: #888; /* Darker grey border on hover */
            }

        #gallery {
            display: flex;
            flex-wrap: wrap;
        }

            #gallery img {
                width: 100px;
                height: auto;
                margin: 5px;
                border: 1px solid #ccc;
            }

        .modal-body {
            max-height: 400px; /* Adjust height as needed */
            overflow-y: auto; /* Enable vertical scrolling */
        }

        .image-container {
            display: inline-block;
            position: relative;
            margin-right: 5px;
            margin-bottom: 10px;
        }

            .image-container img {
                width: 100px; /* Set desired width */
                height: auto;
                margin: 5px;
            }

    </style>


</head>

<body>

    <div id="wrapper">

        <!-- Navigation -->
        <nav class="navbar navbar-inverse navbar-fixed-top" role="navigation">
            <div class="navbar-header">
                <a class="navbar-brand" href="#">Canam Distributors</a>
            </div>

            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>

            <ul class="nav navbar-nav navbar-left navbar-top-links">
                <li><a href="https://canamdistributors.com"><i class="fa fa-home fa-fw"></i> Website</a></li>
            </ul>

            <ul class="nav navbar-right navbar-top-links">
                <li class="dropdown">
                    <a class="dropdown-toggle" data-toggle="dropdown" href="#">
                        <i class="fa fa-user fa-fw"></i> @ViewBag.AdminName <b class="caret"></b>
                    </a>
                    <ul class="dropdown-menu dropdown-user">
                        <li>
                            <a asp-controller="Account" asp-action="LogOut"><i class="fa fa-sign-out fa-fw"></i> Logout</a>
                        </li>
                    </ul>
                </li>
            </ul>
            <!-- /.navbar-top-links -->
        </nav>

        <aside class="sidebar navbar-default" role="navigation">
            <div class="sidebar-nav navbar-collapse">
                <ul class="nav" id="side-menu">
                    <li class="sidebar-search">
                        <div class="input-group custom-search-form">
                            <img src="~/images/logo.webp" alt="BootstrapBrain Logo" width="200" height="38">
                        </div>
                        <!-- /input-group -->
                    </li>
                    <li>
                        <a asp-controller="Account" asp-action="Dashboard" class="active"><i class="fa fa-home fa-fw"></i> Home</a>
                    </li>
                    <li>
                        <a href="#" class="active"><i class="fa fa-shopping-cart fa-fw"></i> Orders</a>
                    </li>
                    <li>
                        <a href="#"><i class="fa fa-tags fa-fw"></i> Sales <span class="fa arrow"></span></a>
                        <ul class="nav nav-second-level">
                            <li>
                                <a asp-controller="Account" asp-action="Products">Products</a>
                            </li>
                            <li>
                                <a asp-controller="Account" asp-action="Collections">Collections</a>
                            </li>
                            <li>
                                <a asp-controller="Account" asp-action="HotDeals">Hot-Deals</a>
                            </li>
                            <li>
                                <a href="#">Inventory</a>
                            </li>
                            <li>
                                <a href="#">Purchase Orders</a>
                            </li>
                            <li>
                                <a href="#"> Transfers</a>
                            </li>
                            <li>
                                <a href="#">Gift Cards</a>
                            </li>
                        </ul>
                        <!-- /.nav-second-level -->
                    </li>
                    <li>
                        <a asp-controller="Account" asp-action="Customers" class="active"><i class="fa fa-users fa-fw"></i> Customers</a>
                    </li>
                </ul>
            </div>
        </aside>
        <!-- /.sidebar -->

        <div id="page-wrapper">
            <div class="container-fluid">
                <div class="row">
                    <div class="col-lg-12">
                        @RenderBody()
                    </div>
                    <!-- /.col-lg-12 -->
                </div>
                <!-- /.row -->
            </div>
            <!-- /.container-fluid -->
        </div>
        <!-- /#page-wrapper -->

    </div>
    <!-- /#wrapper -->
    <!-- jQuery -->@* 
    <div class="modal fade" id="myModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true" data-backdrop="static" data-keyboard="false">
        <div class="modal-dialog" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" onclick="CloseProductHotDealsModal()" aria-hidden="true">&times;</button>
                    <h4 class="modal-title" id="myModalLabel">Add Product Into Hot Deals</h4>
                </div>
                <div class="modal-body">
                    <fieldset>
                        <input type="hidden" id="ProductId" value="" />
                        <div class="form-group">
                            <label for="CategoryImages">Images</label>
                            <div class="file-input">
                                <input type="file" id="fileElem" class="fileElem" name="CategoryImages" accept="image/*" multiple />
                                <span>Select files</span>
                            </div>
                            <div id="gallery" style="margin-top: 10px; display: flex; flex-wrap: wrap;"></div>
                        </div>
                        <div class="form-group">
                            <label for="ProductConditions">Description</label>
                            <textarea id="Description" class="form-control"></textarea>
                        </div>
                        <div class="form-group">
                            <label for="Category">Hot Deal Price</label>
                            <input type="number" id="DiscountPrice" class="form-control" autofocus="true" required />
                        </div>
                    </fieldset>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-primary" onclick="CloseProductHotDealsModal()">Close</button>
                    <button type="button" class="btn btn-primary" onclick="UpdateProductHotDeals()">Save changes</button>
                </div>
            </div>
            <!-- /.modal-content -->
        </div>
        <!-- /.modal-dialog -->
    </div> *@
    <div id="RenderEditHotDealModal"></div>
    <script src="~/js/jquery.min.js"></script>
    <script src="~/js/bootstrap.min.js"></script>
    <script src="~/js/metisMenu.min.js"></script>
    <script src="~/js/dataTables/jquery.dataTables.min.js"></script>
    <script src="~/js/dataTables/dataTables.bootstrap.min.js"></script>
    <script src="~/js/startmin.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-validate/1.19.5/jquery.validate.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-validate-unobtrusive/3.2.11/jquery.validate.unobtrusive.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/select2/4.0.13/js/select2.min.js"></script>
    <script>
        $(document).ready(function () {
            new FroalaEditor('#ProoductConditions');
            new FroalaEditor('#Description');
            $('#dataTables-example').DataTable({
                responsive: true
            });
            $('#ProductList').select2({
                placeholder: "Select Products",
                allowClear: true,
                width: '100%' // Ensure Select2 takes full width
            });
        });

    </script>
    <script>
        // Declare IsActive as a JavaScript variable
        var IsActive = '@IsActive'; // Use Razor to set the value

        function handleCheckboxChange(checkbox, id, discountPrice) {
            $('#ProductId').val(id);
            $('#DiscountPrice').val(discountPrice); // Assuming you have a DiscountPrice input

            if (checkbox.checked) {
                IsActive = "true"; // Update the value when checked
                $('#myModal').modal('show');
                $('#myModal').data('relatedCheckbox', checkbox);
            } else {
                IsActive = "false"; // Update the value when unchecked
                $('#DiscountPrice').val(0);
                UpdateProductHotDeals();
                $('#myModal').modal('hide'); // Close modal if needed
            }
        }

        function UpdateProductHotDeals() {
            // Get values from the input fields
            var productIdValue = $('#ProductId').val();
            var discountPriceValue = $('#DiscountPrice').val();
            var description = $('#Description').val();

            // Check if the Discount Price is empty
            if (!discountPriceValue && discountPriceValue == 0) {
                showToast('Discount Price is required!', 'error');
                $('#myModal').modal('show');
                return;
            }

            // Prepare FormData object
            var formData = new FormData();
            formData.append('productId', productIdValue);
            formData.append('discountPrice', discountPriceValue);
            formData.append('active', IsActive); // Assuming IsActive is defined elsewhere
            formData.append('description', description); // Assuming IsActive is defined elsewhere

            // Get the file input
            var fileInput = document.getElementById('fileElem');
            for (var i = 0; i < fileInput.files.length; i++) {
                formData.append('CategoryImages', fileInput.files[i]);
            }

            // AJAX call to update the product
            $.ajax({
                url: '/Account/UpdateHotDealProduct', // Update with your actual URL
                type: 'POST',
                data: formData,
                processData: false, // Important for FormData
                contentType: false, // Important for FormData
                success: function (response) {
                    if (response.success) {
                        showToast('Product updated successfully!', 'success');
                        $('#myModal').modal('hide');
                        $('#ProductId').val("");
                        // Reload the page after a short delay (optional)
                        setTimeout(function () {
                            location.reload();
                        }, 1000); // Reload after 1 second

                    } else {
                        showToast(response.message || 'Error updating product!', 'error');
                        $('#myModal').modal('show');
                        $('#ProductId').val("");
                    }
                },
                error: function (xhr, status, error) {
                    showToast('An error occurred: ' + error, 'error');
                    $('#myModal').modal('show');
                }
            });
        }


        // Function to show toaster messages
        function showToast(message, type) {
            Toastify({
                text: message,
                duration: 3000, // Duration in milliseconds
                gravity: 'top', // `top` or `bottom`
                position: 'right', // `left`, `center`, or `right`
                backgroundColor: type === 'success' ? 'green' : 'red',
                className: type,
            }).showToast();
        }

        function CloseProductHotDealsModal() {
            var productIdValue = $('#ProductId').val();
            var chckBoxId = "toggleStatus_" + productIdValue;
            // Uncheck the checkbox
            IsActive = "false";
            $('#myModal').modal('hide'); // Close modal if needed
            $('#' + chckBoxId).prop('checked', false);
        }

    </script>

    <script>
        document.addEventListener('DOMContentLoaded', function () {
            const fileInput = document.getElementById('fileElem');
            const gallery = document.getElementById('gallery');

            fileInput.addEventListener('change', function (event) {
                const files = event.target.files;

                Array.from(files).forEach(file => {
                    const reader = new FileReader();
                    reader.onload = function (e) {
                        const container = document.createElement('div');
                        container.classList.add('image-container');

                        const img = document.createElement('img');
                        img.src = e.target.result;

                        const removeButton = document.createElement('button');
                        removeButton.textContent = 'Remove';
                        removeButton.classList.add('remove-image', 'btn', 'btn-danger', 'btn-sm');
                        removeButton.style.marginTop = '5px';
                        removeButton.onclick = function () {
                            container.remove(); // Remove image container on click
                        };

                        container.appendChild(img);
                        container.appendChild(removeButton);
                        gallery.appendChild(container);
                    };
                    reader.readAsDataURL(file);
                });
            });
        });

        function removeImage(button) {
            // Handle potential server-side image removal (if applicable)
            // ... (code to send AJAX request to server to remove image)

            // Remove the image container from the DOM
            button.parentElement.remove();
        }



    </script>

    <script>
        function EditHotDealProduct(productId) {
            $.ajax({
                url: '/Account/EditHotDealProduct', // Update with your actual URL
                type: 'GET',
                data:
                {
                    id: productId,
                },
                success: function (data) {
                    debugger
                    $('#RenderEditHotDealModal').html(data);
                    $('#EditHotProductModal').modal('show');
                },
                error: function (xhr, status, error) {
                    showToast('An error occurred: ' + error, 'error');
                    $('#EditHotProductModal').modal('hide');
                }
            });
        }
    </script>

</body>

</html>